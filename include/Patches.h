/**
 * @file Patches.h
 * @brief FFXV unlock item and patch definitions
 *
 * This file defines all unlock items and code patches for FFXV Windows Edition.
 *
 * UNLOCK MECHANISMS:
 *
 * 1. BYTE TABLE (Direct Memory):
 *    Items at addresses 0x140752038+ have enable bytes that can be toggled.
 *    Setting to 0x01 enables, 0x00 disables. Works for most items.
 *
 * 2. CODE PATCHES (AOB Pattern):
 *    Some items (Steam, Promotional) are protected by anti-tamper and require
 *    code-level patches to bypass ownership checks. These cannot be individually
 *    selected - it's all-or-nothing.
 *
 * ANTI-TAMPER LIMITATION:
 * FFXV crashes if executable code is modified arbitrarily. Only specific patches
 * (Unlock 1, 2, 3) have been found to work. Data modifications (byte table) are safe.
 */

#pragma once

#include <vector>
#include <string>
#include <cstdint>

namespace Patches {

// ============================================================================
// Constants
// ============================================================================

/// Base address of the unlock byte table in FFXV's memory
constexpr uintptr_t UNLOCK_TABLE_BASE = 0x140752038;

// ============================================================================
// Data Structures
// ============================================================================

/**
 * @brief Single unlock item controlled via byte table
 */
struct UnlockItem {
    std::string name;
    std::string description;
    uint8_t itemId;           ///< Offset from UNLOCK_TABLE_BASE
    uintptr_t address;        ///< Computed: UNLOCK_TABLE_BASE + itemId
    bool enabled = false;     ///< Current state (runtime only)
    bool selectable = true;   ///< False if item requires code patch (anti-tamper protected)
};

/**
 * @brief Bundle of items unlocked together (e.g., Twitch Prime pairs)
 */
struct UnlockBundle {
    std::string name;
    std::string description;
    std::vector<uintptr_t> addresses;  ///< All addresses to write when enabling
    bool enabled = false;
};

/**
 * @brief AOB pattern-based code patch
 */
struct Patch {
    std::string name;
    std::string description;
    std::vector<uint8_t> pattern;   ///< Bytes to search for
    std::vector<uint8_t> original;  ///< Original bytes (for restoration)
    std::vector<uint8_t> patched;   ///< Replacement bytes
    int offset;                     ///< Offset from pattern match to patch location
    bool enabled = false;
};

/**
 * @brief Category for UI organization
 */
enum class UnlockCategory {
    NormallyUnavailable,
    TwitchPrime,
    Steam,
    Origin,
    MicrosoftStore,
    Promotional
};

// ============================================================================
// Normally Unavailable Items (Byte Table, Selectable)
// ============================================================================

inline UnlockItem BLAZEFIRE_SABER = {
    "Blazefire Saber", "Unknown promotion", 0x00, 0x140752038, false, true
};
inline UnlockItem NOODLE_HELMET = {
    "Noodle Helmet", "Cup Noodle Promotion", 0x13, 0x14075204B, false, true
};
inline UnlockItem KINGS_KNIGHT_STICKER = {
    "King's Knight Sticker Set", "King's Knight Mobile Game", 0x17, 0x14075204F, false, true
};
inline UnlockItem KINGGLAIVES_PACK = {
    "Kingglaives Pack (COMRADES)", "Unknown", 0x1B, 0x140752053, false, true
};
inline UnlockItem PARTY_PACK = {
    "Party Pack (COMRADES)", "Unknown", 0x1C, 0x140752054, false, true
};
inline UnlockItem MEMORIES_KINGS_KNIGHT = {
    "Memories of KING'S KNIGHT", "King's Knight Mobile Game", 0x1D, 0x140752055, false, true
};
inline UnlockItem KINGS_KNIGHT_TEE = {
    "King's Knight Tee", "King's Knight Mobile Game", 0x1E, 0x140752056, false, true
};

// ============================================================================
// Twitch Prime Bundles (Paired Items)
// ============================================================================

inline UnlockBundle WEATHERWORN_BUNDLE = {
    "Weatherworn Regalia Decal + 16 Rare Coins",
    "Regalia decal and bonus coins",
    {0x140752058, 0x14075205D},  // Decal (0x20) + Coins (0x25)
    false
};
inline UnlockBundle KOOKY_TEE_BUNDLE = {
    "Kooky Chocobo Tee + 100 AP",
    "COMRADES outfit and ability points",
    {0x140752059, 0x14075205C},  // Tee (0x21) + AP (0x24)
    false
};
inline UnlockBundle KOOKY_CHOCOBO_BUNDLE = {
    "Kooky Chocobo + 10,000 GIL",
    "Chocobo companion and bonus gil",
    {0x14075205A, 0x14075205B},  // Chocobo (0x22) + GIL (0x23)
    false
};

// ============================================================================
// Microsoft Store Exclusive (Byte Table, Selectable)
// ============================================================================

inline UnlockItem POWERUP_PACK = {
    "FFXV Powerup Pack", "Dodanuki sword, 10 Phoenix Downs, and 10 Elixirs",
    0x26, 0x14075205E, false, true
};

// ============================================================================
// Steam Exclusives (Anti-Tamper Protected - NOT Selectable)
// ============================================================================

inline UnlockItem FASHION_COLLECTION = {
    "FFXV Fashion Collection", "Steam Pre-Order Bonus - Requires Platform Exclusives patch",
    0x27, 0x14075205F, false, false
};
inline UnlockItem HEV_SUIT = {
    "HEV Suit (COMRADES)", "Half-Life Crossover - Requires Platform Exclusives patch",
    0x29, 0x140752061, false, false
};
inline UnlockItem SCIENTIST_GLASSES = {
    "Scientist Glasses (COMRADES)", "Half-Life Crossover - Requires Platform Exclusives patch",
    0x2C, 0x140752064, false, false
};
inline UnlockItem CROWBAR_COMRADES = {
    "Crowbar (COMRADES)", "Half-Life Crossover - Requires Platform Exclusives patch",
    0x2D, 0x140752065, false, false
};
inline UnlockItem HALFLIFE_COSTUME = {
    "Half-Life Costume", "Half-Life Crossover - Requires Platform Exclusives patch",
    0x2E, 0x140752066, false, false
};
inline UnlockItem CROWBAR = {
    "Crowbar", "Half-Life Crossover - Requires Platform Exclusives patch",
    0x2F, 0x140752067, false, false
};

// ============================================================================
// Origin Exclusives (Byte Table, Selectable)
// ============================================================================

inline UnlockItem DECAL_SELECTION = {
    "FFXV Decal Selection", "Origin Pre-Order Bonus",
    0x28, 0x140752060, false, true
};
inline UnlockItem SIMS4_PACK = {
    "FINAL FANTASY XV THE SIMS 4 PACK", "Origin Exclusive",
    0x2A, 0x140752062, false, true
};

// ============================================================================
// Promotional Items (Anti-Tamper Protected - NOT Selectable)
// ============================================================================

inline UnlockItem INTEL_8700K = {
    "8700K Accessories", "Intel i7-8700K Promotion - Requires Platform Exclusives patch",
    0x30, 0x140752068, false, false
};
inline UnlockItem ALIEN_SHIELD = {
    "Alien Shield", "Unknown Promotion - Requires Platform Exclusives patch",
    0x33, 0x14075206B, false, false
};

// ============================================================================
// URL Redirect Patches (Twitch Prime Spoofing)
// ============================================================================

/// Redirects Twitch OAuth2 authorize URL to localhost:443
inline Patch URL_OAUTH2_AUTHORIZE = {
    "OAuth2 URL Redirect",
    "Redirects Twitch OAuth2 authorize URL to localhost",
    // Pattern: "https://api.twitch.tv/kraken/oauth2/authorize?..."
    {0x68, 0x74, 0x74, 0x70, 0x73, 0x3A, 0x2F, 0x2F, 0x61, 0x70, 0x69, 0x2E,
     0x74, 0x77, 0x69, 0x74, 0x63, 0x68, 0x2E, 0x74, 0x76, 0x2F, 0x6B, 0x72,
     0x61, 0x6B, 0x65, 0x6E, 0x2F, 0x6F, 0x61, 0x75, 0x74, 0x68, 0x32, 0x2F,
     0x61, 0x75, 0x74, 0x68, 0x6F, 0x72, 0x69, 0x7A, 0x65, 0x3F, 0x72, 0x65,
     0x73, 0x70, 0x6F, 0x6E, 0x73, 0x65, 0x5F, 0x74, 0x79, 0x70, 0x65, 0x3D,
     0x74, 0x6F, 0x6B, 0x65, 0x6E, 0x2B, 0x69, 0x64, 0x5F, 0x74, 0x6F, 0x6B,
     0x65, 0x6E, 0x26, 0x63, 0x6C, 0x69, 0x65, 0x6E, 0x74, 0x5F, 0x69, 0x64,
     0x3D, 0x25, 0x73, 0x26, 0x72, 0x65, 0x64, 0x69, 0x72, 0x65, 0x63, 0x74,
     0x5F, 0x75, 0x72, 0x69, 0x3D, 0x68, 0x74, 0x74, 0x70, 0x3A, 0x2F, 0x2F,
     0x6C, 0x6F, 0x63, 0x61, 0x6C, 0x68, 0x6F, 0x73, 0x74, 0x26, 0x73, 0x63,
     0x6F, 0x70, 0x65, 0x3D, 0x75, 0x73, 0x65, 0x72, 0x5F, 0x72, 0x65, 0x61,
     0x64, 0x2B, 0x6F, 0x70, 0x65, 0x6E, 0x69, 0x64, 0x26, 0x66, 0x6F, 0x72,
     0x63, 0x65, 0x5F, 0x76, 0x65, 0x72, 0x69, 0x66, 0x79, 0x3D, 0x74, 0x72,
     0x75, 0x65, 0x26, 0x73, 0x74, 0x61, 0x74, 0x65, 0x3D, 0x25, 0x73},
    // Original bytes (same as pattern for full replacement)
    {0x68, 0x74, 0x74, 0x70, 0x73, 0x3A, 0x2F, 0x2F, 0x61, 0x70, 0x69, 0x2E,
     0x74, 0x77, 0x69, 0x74, 0x63, 0x68, 0x2E, 0x74, 0x76, 0x2F, 0x6B, 0x72,
     0x61, 0x6B, 0x65, 0x6E, 0x2F, 0x6F, 0x61, 0x75, 0x74, 0x68, 0x32, 0x2F,
     0x61, 0x75, 0x74, 0x68, 0x6F, 0x72, 0x69, 0x7A, 0x65, 0x3F, 0x72, 0x65,
     0x73, 0x70, 0x6F, 0x6E, 0x73, 0x65, 0x5F, 0x74, 0x79, 0x70, 0x65, 0x3D,
     0x74, 0x6F, 0x6B, 0x65, 0x6E, 0x2B, 0x69, 0x64, 0x5F, 0x74, 0x6F, 0x6B,
     0x65, 0x6E, 0x26, 0x63, 0x6C, 0x69, 0x65, 0x6E, 0x74, 0x5F, 0x69, 0x64,
     0x3D, 0x25, 0x73, 0x26, 0x72, 0x65, 0x64, 0x69, 0x72, 0x65, 0x63, 0x74,
     0x5F, 0x75, 0x72, 0x69, 0x3D, 0x68, 0x74, 0x74, 0x70, 0x3A, 0x2F, 0x2F,
     0x6C, 0x6F, 0x63, 0x61, 0x6C, 0x68, 0x6F, 0x73, 0x74, 0x26, 0x73, 0x63,
     0x6F, 0x70, 0x65, 0x3D, 0x75, 0x73, 0x65, 0x72, 0x5F, 0x72, 0x65, 0x61,
     0x64, 0x2B, 0x6F, 0x70, 0x65, 0x6E, 0x69, 0x64, 0x26, 0x66, 0x6F, 0x72,
     0x63, 0x65, 0x5F, 0x76, 0x65, 0x72, 0x69, 0x66, 0x79, 0x3D, 0x74, 0x72,
     0x75, 0x65, 0x26, 0x73, 0x74, 0x61, 0x74, 0x65, 0x3D, 0x25, 0x73},
    // Patched: "http://localhost:443/kraken/oauth2/authorize?..."
    {0x68, 0x74, 0x74, 0x70, 0x3A, 0x2F, 0x2F, 0x6C, 0x6F, 0x63, 0x61, 0x6C,
     0x68, 0x6F, 0x73, 0x74, 0x3A, 0x34, 0x34, 0x33, 0x2F, 0x6B, 0x72, 0x61,
     0x6B, 0x65, 0x6E, 0x2F, 0x6F, 0x61, 0x75, 0x74, 0x68, 0x32, 0x2F, 0x61,
     0x75, 0x74, 0x68, 0x6F, 0x72, 0x69, 0x7A, 0x65, 0x3F, 0x72, 0x65, 0x73,
     0x70, 0x6F, 0x6E, 0x73, 0x65, 0x5F, 0x74, 0x79, 0x70, 0x65, 0x3D, 0x74,
     0x6F, 0x6B, 0x65, 0x6E, 0x2B, 0x69, 0x64, 0x5F, 0x74, 0x6F, 0x6B, 0x65,
     0x6E, 0x26, 0x63, 0x6C, 0x69, 0x65, 0x6E, 0x74, 0x5F, 0x69, 0x64, 0x3D,
     0x25, 0x73, 0x26, 0x72, 0x65, 0x64, 0x69, 0x72, 0x65, 0x63, 0x74, 0x5F,
     0x75, 0x72, 0x69, 0x3D, 0x68, 0x74, 0x74, 0x70, 0x3A, 0x2F, 0x2F, 0x6C,
     0x6F, 0x63, 0x61, 0x6C, 0x68, 0x6F, 0x73, 0x74, 0x26, 0x73, 0x63, 0x6F,
     0x70, 0x65, 0x3D, 0x75, 0x73, 0x65, 0x72, 0x5F, 0x72, 0x65, 0x61, 0x64,
     0x2B, 0x6F, 0x70, 0x65, 0x6E, 0x69, 0x64, 0x26, 0x66, 0x6F, 0x72, 0x63,
     0x65, 0x5F, 0x76, 0x65, 0x72, 0x69, 0x66, 0x79, 0x3D, 0x74, 0x72, 0x75,
     0x65, 0x26, 0x73, 0x74, 0x61, 0x74, 0x65, 0x3D, 0x25, 0x73, 0x00},
    0
};

/// Redirects Twitch API base URL to localhost:443
inline Patch URL_API_BASE = {
    "API Base URL Redirect",
    "Redirects Twitch API base URL to localhost",
    // Pattern: "https://api.twitch.tv/"
    {0x68, 0x74, 0x74, 0x70, 0x73, 0x3A, 0x2F, 0x2F, 0x61, 0x70, 0x69, 0x2E,
     0x74, 0x77, 0x69, 0x74, 0x63, 0x68, 0x2E, 0x74, 0x76, 0x2F, 0x00},
    {0x68, 0x74, 0x74, 0x70, 0x73, 0x3A, 0x2F, 0x2F, 0x61, 0x70, 0x69, 0x2E,
     0x74, 0x77, 0x69, 0x74, 0x63, 0x68, 0x2E, 0x74, 0x76, 0x2F, 0x00},
    // Patched: "http://localhost:443/"
    {0x68, 0x74, 0x74, 0x70, 0x3A, 0x2F, 0x2F, 0x6C, 0x6F, 0x63, 0x61, 0x6C,
     0x68, 0x6F, 0x73, 0x74, 0x3A, 0x34, 0x34, 0x33, 0x2F, 0x00, 0x00},
    0
};

/// Redirects Twitch blog URL to local page
inline Patch URL_BLOG = {
    "Blog URL Redirect",
    "Redirects Twitch blog URL to local page",
    // Pattern: "https://blog.twitch.tv/twitch-prime-members..."
    {0x68, 0x74, 0x74, 0x70, 0x73, 0x3A, 0x2F, 0x2F, 0x62, 0x6C, 0x6F, 0x67,
     0x2E, 0x74, 0x77, 0x69, 0x74, 0x63, 0x68, 0x2E, 0x74, 0x76, 0x2F, 0x74,
     0x77, 0x69, 0x74, 0x63, 0x68, 0x2D, 0x70, 0x72, 0x69, 0x6D, 0x65, 0x2D,
     0x6D, 0x65, 0x6D, 0x62, 0x65, 0x72, 0x73, 0x2D, 0x67, 0x65, 0x74, 0x2D,
     0x79, 0x6F, 0x75, 0x72, 0x2D, 0x6F, 0x77, 0x6E, 0x2D, 0x6B, 0x6F, 0x6F,
     0x6B, 0x79, 0x2D, 0x63, 0x68, 0x6F, 0x63, 0x6F, 0x62, 0x6F, 0x2D, 0x6D,
     0x6F, 0x72, 0x65, 0x2D, 0x69, 0x6E, 0x2D, 0x66, 0x69, 0x6E, 0x61, 0x6C,
     0x2D, 0x66, 0x61, 0x6E, 0x74, 0x61, 0x73, 0x79, 0x2D, 0x78, 0x76, 0x2D,
     0x77, 0x69, 0x6E, 0x64, 0x6F, 0x77, 0x73, 0x2D, 0x65, 0x64, 0x69, 0x74,
     0x69, 0x6F, 0x6E, 0x2D, 0x38, 0x37, 0x64, 0x30, 0x34, 0x63, 0x36, 0x61,
     0x65, 0x32, 0x31, 0x37},
    {0x68, 0x74, 0x74, 0x70, 0x73, 0x3A, 0x2F, 0x2F, 0x62, 0x6C, 0x6F, 0x67,
     0x2E, 0x74, 0x77, 0x69, 0x74, 0x63, 0x68, 0x2E, 0x74, 0x76, 0x2F, 0x74,
     0x77, 0x69, 0x74, 0x63, 0x68, 0x2D, 0x70, 0x72, 0x69, 0x6D, 0x65, 0x2D,
     0x6D, 0x65, 0x6D, 0x62, 0x65, 0x72, 0x73, 0x2D, 0x67, 0x65, 0x74, 0x2D,
     0x79, 0x6F, 0x75, 0x72, 0x2D, 0x6F, 0x77, 0x6E, 0x2D, 0x6B, 0x6F, 0x6F,
     0x6B, 0x79, 0x2D, 0x63, 0x68, 0x6F, 0x63, 0x6F, 0x62, 0x6F, 0x2D, 0x6D,
     0x6F, 0x72, 0x65, 0x2D, 0x69, 0x6E, 0x2D, 0x66, 0x69, 0x6E, 0x61, 0x6C,
     0x2D, 0x66, 0x61, 0x6E, 0x74, 0x61, 0x73, 0x79, 0x2D, 0x78, 0x76, 0x2D,
     0x77, 0x69, 0x6E, 0x64, 0x6F, 0x77, 0x73, 0x2D, 0x65, 0x64, 0x69, 0x74,
     0x69, 0x6F, 0x6E, 0x2D, 0x38, 0x37, 0x64, 0x30, 0x34, 0x63, 0x36, 0x61,
     0x65, 0x32, 0x31, 0x37},
    // Patched: "http://localhost:443/twitch-prime-members..."
    {0x68, 0x74, 0x74, 0x70, 0x3A, 0x2F, 0x2F, 0x6C, 0x6F, 0x63, 0x61, 0x6C,
     0x68, 0x6F, 0x73, 0x74, 0x3A, 0x34, 0x34, 0x33, 0x2F, 0x74, 0x77, 0x69,
     0x74, 0x63, 0x68, 0x2D, 0x70, 0x72, 0x69, 0x6D, 0x65, 0x2D, 0x6D, 0x65,
     0x6D, 0x62, 0x65, 0x72, 0x73, 0x2D, 0x67, 0x65, 0x74, 0x2D, 0x79, 0x6F,
     0x75, 0x72, 0x2D, 0x6F, 0x77, 0x6E, 0x2D, 0x6B, 0x6F, 0x6F, 0x6B, 0x79,
     0x2D, 0x63, 0x68, 0x6F, 0x63, 0x6F, 0x62, 0x6F, 0x2D, 0x6D, 0x6F, 0x72,
     0x65, 0x2D, 0x69, 0x6E, 0x2D, 0x66, 0x69, 0x6E, 0x61, 0x6C, 0x2D, 0x66,
     0x61, 0x6E, 0x74, 0x61, 0x73, 0x79, 0x2D, 0x78, 0x76, 0x2D, 0x77, 0x69,
     0x6E, 0x64, 0x6F, 0x77, 0x73, 0x2D, 0x65, 0x64, 0x69, 0x74, 0x69, 0x6F,
     0x6E, 0x2D, 0x38, 0x37, 0x64, 0x30, 0x34, 0x63, 0x36, 0x61, 0x65, 0x32,
     0x31, 0x37, 0x00, 0x00},
    0
};

// ============================================================================
// Platform Exclusive Unlock Patches
// ============================================================================

/**
 * Unlock 1 - Bounds Bypass
 * Required before Unlock 2. Changes conditional jump to unconditional.
 * Pattern: cmp eax,33; ja +1A -> cmp eax,33; jmp +1A
 */
inline Patch UNLOCK1_BOUNDS_BYPASS = {
    "Unlock 1 - Bounds Bypass",
    "Forces all items through unlock path",
    {0x83, 0xF8, 0x33, 0x77, 0x1A},  // cmp eax,33; ja +1A
    {0x77, 0x1A},                     // ja +1A (original)
    {0xEB, 0x1A},                     // jmp +1A (patched)
    3                                 // Offset to ja instruction
};

/**
 * Unlock 2 - Steam Bypass (requires Unlock 1)
 * Clears r12 and CF for Steam/Promotional items.
 * Pattern: xor r12l,01; cmp ebp,14 -> xor r12,r12; cmp r12l,dl; clc
 */
inline Patch UNLOCK2_STEAM_BYPASS = {
    "Unlock 2 - Steam Bypass",
    "Clears r12 and CF for Steam/Promotional items",
    {0x41, 0x80, 0xF4, 0x01, 0x83, 0xFD, 0x14},  // xor r12l,01; cmp ebp,14
    {0x41, 0x80, 0xF4, 0x01, 0x83, 0xFD, 0x14},  // Original (7 bytes)
    {0x4D, 0x31, 0xE4, 0x41, 0x38, 0xD4, 0xF8},  // xor r12,r12; cmp r12l,dl; clc
    0
};

/**
 * Unlock 3 - DL Bypass (Ownership Gate)
 * NOPs the jump that skips items with DL=0.
 * Use this alone for "Everything without Steam Workshop".
 * Pattern: test dl,dl; je +4F -> test dl,dl; nop nop
 */
inline Patch UNLOCK3_DL_BYPASS = {
    "Unlock 3 - DL Bypass",
    "NOPs ownership check jump - unlocks all platform exclusives",
    {0x84, 0xD2, 0x74, 0x4F, 0xEB, 0x0D},  // test dl,dl; je +4F; jmp +0D
    {0x74, 0x4F},                           // je +4F (original)
    {0x90, 0x90},                           // nop nop (patched)
    2                                       // Offset to je instruction
};

// ============================================================================
// Twitch Prime Reward Patches
// ============================================================================

inline Patch NOP_GOODS_ARRAY_SIZE_CHECK = {
    "Bypass Goods Array Size Check",
    "NOPs the conditional jump that validates goods array size",
    {0x0F, 0x1F, 0x80, 0x00, 0x00, 0x00, 0x00, 0x44, 0x8B, 0xC6, 0x48},
    {0x0F, 0x8E, 0x10, 0x01, 0x00, 0x00},
    {0x90, 0x90, 0x90, 0x90, 0x90, 0x90},
    -6
};

inline Patch FFXV_TP_001 = {
    "Kooky Chocobo",
    "Unlocks Kooky Chocobo companion",
    {0x41, 0xB0, 0x01, 0xBA, 0x23, 0x00, 0x00, 0x00},
    {0x48, 0x85, 0xC0, 0x74, 0x17},
    {0x83, 0xFE, 0x01, 0x73, 0x17},
    -5
};

inline Patch FFXV_TP_002 = {
    "10,000 Gil",
    "Unlocks 10,000 Gil bonus",
    {0x41, 0xB0, 0x01, 0xBA, 0x22, 0x00, 0x00, 0x00, 0x48, 0x8B, 0xCB},
    {0x48, 0x85, 0xC0, 0x74, 0x17},
    {0x83, 0xFE, 0x02, 0x73, 0x17},
    -5
};

inline Patch FFXV_TP_003 = {
    "100 AP",
    "Unlocks 100 AP bonus",
    {0x41, 0xB0, 0x01, 0xBA, 0x21, 0x00, 0x00, 0x00},
    {0x48, 0x85, 0xC0, 0x74, 0x21},
    {0x83, 0xFE, 0x03, 0x73, 0x21},
    -5
};

inline Patch CHECK_ITERATIONS = {
    "Force 3 Iterations",
    "Forces the reward check loop to iterate exactly 3 times",
    {0xFF, 0xC6, 0x48, 0x8D, 0x4D, 0x20},
    {0xFF, 0xC6, 0x48, 0x8D, 0x4D},
    {0xB8, 0x03, 0x00, 0x00, 0x00},
    6
};

// ============================================================================
// Collection Accessors
// ============================================================================

inline std::vector<UnlockItem*> getNormallyUnavailableItems() {
    return {
        &BLAZEFIRE_SABER, &NOODLE_HELMET, &KINGS_KNIGHT_STICKER,
        &KINGGLAIVES_PACK, &PARTY_PACK, &MEMORIES_KINGS_KNIGHT, &KINGS_KNIGHT_TEE
    };
}

inline std::vector<UnlockBundle*> getTwitchPrimeBundles() {
    return { &WEATHERWORN_BUNDLE, &KOOKY_TEE_BUNDLE, &KOOKY_CHOCOBO_BUNDLE };
}

inline std::vector<UnlockItem*> getSteamItems() {
    return {
        &FASHION_COLLECTION, &HEV_SUIT, &SCIENTIST_GLASSES,
        &CROWBAR_COMRADES, &HALFLIFE_COSTUME, &CROWBAR
    };
}

inline std::vector<UnlockItem*> getOriginItems() {
    return { &DECAL_SELECTION, &SIMS4_PACK };
}

inline std::vector<UnlockItem*> getMicrosoftStoreItems() {
    return { &POWERUP_PACK };
}

inline std::vector<UnlockItem*> getPromotionalItems() {
    return { &INTEL_8700K, &ALIEN_SHIELD };
}

inline std::vector<UnlockItem*> getAllUnlockItems() {
    std::vector<UnlockItem*> all;
    auto add = [&all](std::vector<UnlockItem*> items) {
        all.insert(all.end(), items.begin(), items.end());
    };
    add(getNormallyUnavailableItems());
    add(getSteamItems());
    add(getOriginItems());
    add(getMicrosoftStoreItems());
    add(getPromotionalItems());
    return all;
}

/// Returns only items that can be individually toggled (not anti-tamper protected)
inline std::vector<UnlockItem*> getSelectableItems() {
    std::vector<UnlockItem*> items;
    for (auto* item : getAllUnlockItems()) {
        if (item->selectable) {
            items.push_back(item);
        }
    }
    return items;
}

inline std::vector<Patch*> getAllPatches() {
    return {
        &URL_OAUTH2_AUTHORIZE, &URL_API_BASE, &URL_BLOG,
        &UNLOCK1_BOUNDS_BYPASS, &UNLOCK2_STEAM_BYPASS, &UNLOCK3_DL_BYPASS,
        &NOP_GOODS_ARRAY_SIZE_CHECK, &FFXV_TP_001, &FFXV_TP_002, &FFXV_TP_003,
        &CHECK_ITERATIONS
    };
}

inline std::vector<Patch*> getURLPatches() {
    return { &URL_OAUTH2_AUTHORIZE, &URL_API_BASE, &URL_BLOG };
}

inline std::vector<Patch*> getTwitchPrimePatches() {
    return {
        &NOP_GOODS_ARRAY_SIZE_CHECK,
        &FFXV_TP_001, &FFXV_TP_002, &FFXV_TP_003,
        &CHECK_ITERATIONS
    };
}

/// Unlock 1 + Unlock 2: Everything including Steam Workshop items
inline std::vector<Patch*> getUnlockAllWithWorkshopPatches() {
    return { &UNLOCK1_BOUNDS_BYPASS, &UNLOCK2_STEAM_BYPASS };
}

/// Unlock 3 only: Everything except Steam Workshop items
inline std::vector<Patch*> getUnlockAllWithoutWorkshopPatches() {
    return { &UNLOCK3_DL_BYPASS };
}

inline Patch* getUnlock1Patch() { return &UNLOCK1_BOUNDS_BYPASS; }
inline Patch* getUnlock2Patch() { return &UNLOCK2_STEAM_BYPASS; }
inline Patch* getUnlock3Patch() { return &UNLOCK3_DL_BYPASS; }

/// Returns true if item requires Platform Exclusives patch (not selectable)
inline bool itemRequiresDLBypass(const UnlockItem* item) {
    return !item->selectable;
}

} // namespace Patches
